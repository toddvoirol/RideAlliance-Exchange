<div class="auth-container">
  <main class="auth-main">
    <div class="auth-card">
      <div class="auth-card-header">
        <h2 class="auth-title">Reset Password</h2>
      </div>

      <div class="auth-card-body">
        <div *ngIf="loading">Verifying...</div>

        <div *ngIf="!loading && emailForReset">
          <p>Reset password for <strong>{{ emailForReset }}</strong></p>

          <form [formGroup]="resetForm" (ngSubmit)="submit()">
            <div class="form-group">
              <label for="password">New password</label>
              <input id="password" type="password" class="form-control" formControlName="password" />
              <div class="password-strength" style="margin-top:8px;">
                <div class="strength-bar" [style.width.%]="strengthPercent"></div>
                <small>{{ strengthLabel }}</small>
              </div>
              <div class="text-danger" *ngIf="resetForm.get('password')?.touched && resetForm.get('password')?.invalid">
                <div *ngIf="resetForm.get('password')?.hasError('required')">Password is required.</div>
                <div *ngIf="resetForm.get('password')?.hasError('minlength')">Password must be at least 8 characters.</div>
              </div>
              <ul class="password-rules" style="font-size:12px; margin-top:6px;">
                <li [class.text-success]="hasMinLen">At least 8 characters</li>
                <li [class.text-success]="hasUpper">Uppercase letter</li>
                <li [class.text-success]="hasLower">Lowercase letter</li>
                <li [class.text-success]="hasNumber">Number</li>
                <li [class.text-success]="hasSpecial">Special character</li>
              </ul>
            </div>

            <div class="form-group">
              <label for="confirmPassword">Confirm password</label>
              <input id="confirmPassword" type="password" class="form-control" formControlName="confirmPassword" />
              <div class="text-danger" *ngIf="resetForm.get('confirmPassword')?.touched && resetForm.get('confirmPassword')?.invalid">
                <div *ngIf="resetForm.get('confirmPassword')?.hasError('required')">Please confirm your password.</div>
              </div>
            </div>

            <div class="form-actions">
              <button type="submit" class="btn btn-primary" [disabled]="resetForm.invalid || loading">Reset Password</button>
            </div>
          </form>
        </div>

        <div *ngIf="!loading && !emailForReset">
          <div class="alert alert-warning">Invalid or expired password reset link.</div>
        </div>
      </div>
    </div>
  </main>
</div>
